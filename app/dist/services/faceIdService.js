var a6_0x4384=['__awaiter','next','throw','done','value','then','__esModule','hasOwnProperty','default','face-api.js','../commons','fs-extra','folder','FILES_FOLDER','authorized_driver.jpg','threshold','previousResult','countResult','FaceIdService\x20init','getInstance','instance','init','loadFromDisk','../weights','faceLandmark68Net','nets','faceRecognitionNet','run','log','REFERENCE_IMAGE','QUERY_IMAGE','existsSync','canvas','loadImage','computeFaceDescriptor','detectAllFaces','faceDetectionOptions','catch','utils','round','euclideanDistance','prototype','slice','call','length','(no\x20reference\x20face)','(no\x20query\x20face)','(no\x20match)','(match)','result','sendFaceResult','connect','localhost','Connected','stringify','data','Received:\x20','destroy','Connection\x20closed','FaceIdService'];(function(_0x1958f8,_0x3cf597){var _0x4c4a59=function(_0x31aeaa){while(--_0x31aeaa){_0x1958f8['push'](_0x1958f8['shift']());}};_0x4c4a59(++_0x3cf597);}(a6_0x4384,0x168));var a6_0x299d=function(_0xbed9f9,_0x1cba1c){_0xbed9f9=_0xbed9f9-0x0;var _0x23e514=a6_0x4384[_0xbed9f9];return _0x23e514;};'use strict';var __awaiter=this&&this[a6_0x299d('0x0')]||function(_0x2d8c05,_0x420836,_0x3c77c9,_0xb6b614){function _0x41b9eb(_0x9f7429){return _0x9f7429 instanceof _0x3c77c9?_0x9f7429:new _0x3c77c9(function(_0x15e930){_0x15e930(_0x9f7429);});}return new(_0x3c77c9||(_0x3c77c9=Promise))(function(_0x48af51,_0x249a07){function _0x29bf5d(_0x39a7c3){try{_0x2902b0(_0xb6b614[a6_0x299d('0x1')](_0x39a7c3));}catch(_0x5278c1){_0x249a07(_0x5278c1);}}function _0xf95fd5(_0x48408d){try{_0x2902b0(_0xb6b614[a6_0x299d('0x2')](_0x48408d));}catch(_0x495b41){_0x249a07(_0x495b41);}}function _0x2902b0(_0x34acf2){_0x34acf2[a6_0x299d('0x3')]?_0x48af51(_0x34acf2[a6_0x299d('0x4')]):_0x41b9eb(_0x34acf2[a6_0x299d('0x4')])[a6_0x299d('0x5')](_0x29bf5d,_0xf95fd5);}_0x2902b0((_0xb6b614=_0xb6b614['apply'](_0x2d8c05,_0x420836||[]))[a6_0x299d('0x1')]());});};var __importStar=this&&this['__importStar']||function(_0x2cef4b){if(_0x2cef4b&&_0x2cef4b[a6_0x299d('0x6')])return _0x2cef4b;var _0x21891e={};if(_0x2cef4b!=null)for(var _0x187a35 in _0x2cef4b)if(Object[a6_0x299d('0x7')]['call'](_0x2cef4b,_0x187a35))_0x21891e[_0x187a35]=_0x2cef4b[_0x187a35];_0x21891e[a6_0x299d('0x8')]=_0x2cef4b;return _0x21891e;};Object['defineProperty'](exports,'__esModule',{'value':!![]});const faceapi=__importStar(require(a6_0x299d('0x9')));const commons_1=require(a6_0x299d('0xa'));const net=require('net');const fsExtra=require(a6_0x299d('0xb'));class FaceIdService{constructor(){this['locationParts']={'latitude':'','longitude':'','speed':'','hdop':''};this[a6_0x299d('0xc')]=process['env'][a6_0x299d('0xd')];this['REFERENCE_IMAGE']=this[a6_0x299d('0xc')]+a6_0x299d('0xe');this['QUERY_IMAGE']=this[a6_0x299d('0xc')]+'current_driver.jpg';this[a6_0x299d('0xf')]=0.6;this[a6_0x299d('0x10')]=0x0;this[a6_0x299d('0x11')]=0x0;console['log'](a6_0x299d('0x12'));this['init']();}static[a6_0x299d('0x13')](){if(!FaceIdService[a6_0x299d('0x14')]){FaceIdService['instance']=new FaceIdService();}return FaceIdService[a6_0x299d('0x14')];}[a6_0x299d('0x15')](){return __awaiter(this,void 0x0,void 0x0,function*(){yield commons_1['faceDetectionNet'][a6_0x299d('0x16')](a6_0x299d('0x17'));yield faceapi['nets'][a6_0x299d('0x18')][a6_0x299d('0x16')]('../weights');yield faceapi[a6_0x299d('0x19')][a6_0x299d('0x1a')][a6_0x299d('0x16')]('../weights');setInterval(()=>{this[a6_0x299d('0x1b')]();},0x3e8);});}[a6_0x299d('0x1b')](){return __awaiter(this,void 0x0,void 0x0,function*(){console[a6_0x299d('0x1c')](a6_0x299d('0x1d'),this[a6_0x299d('0x1d')]);console[a6_0x299d('0x1c')]('QUERY_IMAGE',this[a6_0x299d('0x1e')]);let _0x501e19=0x3;let _0x2eed77=null;let _0x4fca5e=null;let _0x5b7bfe=null;if(fsExtra[a6_0x299d('0x1f')](this['REFERENCE_IMAGE'])){_0x2eed77=yield commons_1[a6_0x299d('0x20')][a6_0x299d('0x21')](this[a6_0x299d('0x1d')])['catch'](function(_0x1f0ba8){});_0x4fca5e=yield faceapi[a6_0x299d('0x22')](_0x2eed77);_0x5b7bfe=yield faceapi[a6_0x299d('0x23')](_0x2eed77,commons_1[a6_0x299d('0x24')]);}let _0xfafd95=null;let _0x489dba=null;let _0x21f10e=null;if(fsExtra['existsSync'](this['QUERY_IMAGE'])){_0xfafd95=yield commons_1['canvas'][a6_0x299d('0x21')](this[a6_0x299d('0x1e')])[a6_0x299d('0x25')](function(_0x320593){});_0x489dba=yield faceapi[a6_0x299d('0x22')](_0xfafd95);_0x21f10e=yield faceapi[a6_0x299d('0x23')](_0xfafd95,commons_1['faceDetectionOptions']);}let _0x3d67b2=0x1;if(_0x4fca5e&&_0x489dba){_0x3d67b2=faceapi[a6_0x299d('0x26')][a6_0x299d('0x27')](faceapi[a6_0x299d('0x28')](Array[a6_0x299d('0x29')][a6_0x299d('0x2a')][a6_0x299d('0x2b')](_0x4fca5e),Array[a6_0x299d('0x29')][a6_0x299d('0x2a')][a6_0x299d('0x2b')](_0x489dba)));}if(_0x5b7bfe!=null&&_0x5b7bfe[a6_0x299d('0x2c')]==0x0){_0x501e19=0x2;console[a6_0x299d('0x1c')](a6_0x299d('0x2d'),new Date(),_0x3d67b2);}else if(_0x21f10e!=null&&_0x21f10e[a6_0x299d('0x2c')]==0x0){_0x501e19=0x3;console[a6_0x299d('0x1c')](a6_0x299d('0x2e'),new Date(),_0x3d67b2);}else{if(_0x3d67b2>this[a6_0x299d('0xf')]){_0x501e19=0x2;console[a6_0x299d('0x1c')](a6_0x299d('0x2f'),new Date(),_0x3d67b2);}else{_0x501e19=0x1;console[a6_0x299d('0x1c')](a6_0x299d('0x30'),new Date(),_0x3d67b2);}}if(_0x501e19==this[a6_0x299d('0x10')]){this[a6_0x299d('0x11')]++;}else{this[a6_0x299d('0x11')]=0x0;}this[a6_0x299d('0x10')]=_0x501e19;console[a6_0x299d('0x1c')](a6_0x299d('0x31'),_0x501e19,this[a6_0x299d('0x11')]);if(this[a6_0x299d('0x11')]==0x5){this[a6_0x299d('0x32')](_0x501e19);}});}[a6_0x299d('0x32')](_0x35b82d){const _0x199ed4=new net['Socket']();try{_0x199ed4[a6_0x299d('0x33')](0x2af8,a6_0x299d('0x34'),function(){console[a6_0x299d('0x1c')](a6_0x299d('0x35'));const _0x2f6a18=JSON[a6_0x299d('0x36')]({'action':'face_id','data':_0x35b82d});_0x199ed4['write'](_0x2f6a18);});_0x199ed4['on'](a6_0x299d('0x37'),function(_0x35b82d){console[a6_0x299d('0x1c')](a6_0x299d('0x38')+_0x35b82d);_0x199ed4[a6_0x299d('0x39')]();});_0x199ed4['on']('close',function(){console[a6_0x299d('0x1c')](a6_0x299d('0x3a'));});}catch(_0x59391e){console[a6_0x299d('0x1c')]('error',_0x59391e);}}}exports[a6_0x299d('0x3b')]=FaceIdService;