var a6_0x5512=['hasOwnProperty','call','default','defineProperty','__esModule','face-api.js','../commons','net','locationParts','folder','env','FILES_FOLDER','REFERENCE_IMAGE','QUERY_IMAGE','current_driver.jpg','threshold','previousResult','countResult','FaceIdService\x20init','init','getInstance','instance','faceDetectionNet','loadFromDisk','../weights','nets','faceLandmark68Net','run','log','existsSync','catch','computeFaceDescriptor','faceDetectionOptions','loadImage','detectAllFaces','utils','round','euclideanDistance','prototype','slice','(no\x20reference\x20face)','length','(no\x20query\x20face)','(no\x20match)','result','sendFaceResult','Socket','connect','localhost','Connected','write','destroy','close','Connection\x20closed','error','FaceIdService','__awaiter','next','throw','value','then','__importStar'];(function(_0x1604a1,_0x488902){var _0x324fcb=function(_0xb24fee){while(--_0xb24fee){_0x1604a1['push'](_0x1604a1['shift']());}};_0x324fcb(++_0x488902);}(a6_0x5512,0xb4));var a6_0x422e=function(_0x47ab9b,_0x10e378){_0x47ab9b=_0x47ab9b-0x0;var _0x3ef883=a6_0x5512[_0x47ab9b];return _0x3ef883;};'use strict';var __awaiter=this&&this[a6_0x422e('0x0')]||function(_0x581175,_0xbd7fd8,_0x6935a1,_0x4cb49f){function _0x137fe1(_0xb31015){return _0xb31015 instanceof _0x6935a1?_0xb31015:new _0x6935a1(function(_0x58975f){_0x58975f(_0xb31015);});}return new(_0x6935a1||(_0x6935a1=Promise))(function(_0x5e72d3,_0x1cab5d){function _0x433440(_0x1f12b8){try{_0x91bfa6(_0x4cb49f[a6_0x422e('0x1')](_0x1f12b8));}catch(_0x552e31){_0x1cab5d(_0x552e31);}}function _0x7d03e(_0xfe2a92){try{_0x91bfa6(_0x4cb49f[a6_0x422e('0x2')](_0xfe2a92));}catch(_0x2d74a0){_0x1cab5d(_0x2d74a0);}}function _0x91bfa6(_0x2c1666){_0x2c1666['done']?_0x5e72d3(_0x2c1666[a6_0x422e('0x3')]):_0x137fe1(_0x2c1666[a6_0x422e('0x3')])[a6_0x422e('0x4')](_0x433440,_0x7d03e);}_0x91bfa6((_0x4cb49f=_0x4cb49f['apply'](_0x581175,_0xbd7fd8||[]))[a6_0x422e('0x1')]());});};var __importStar=this&&this[a6_0x422e('0x5')]||function(_0x3a5405){if(_0x3a5405&&_0x3a5405['__esModule'])return _0x3a5405;var _0x2efe94={};if(_0x3a5405!=null)for(var _0x57cdbe in _0x3a5405)if(Object[a6_0x422e('0x6')][a6_0x422e('0x7')](_0x3a5405,_0x57cdbe))_0x2efe94[_0x57cdbe]=_0x3a5405[_0x57cdbe];_0x2efe94[a6_0x422e('0x8')]=_0x3a5405;return _0x2efe94;};Object[a6_0x422e('0x9')](exports,a6_0x422e('0xa'),{'value':!![]});const faceapi=__importStar(require(a6_0x422e('0xb')));const commons_1=require(a6_0x422e('0xc'));const net=require(a6_0x422e('0xd'));const fsExtra=require('fs-extra');class FaceIdService{constructor(){this[a6_0x422e('0xe')]={'latitude':'','longitude':'','speed':'','hdop':''};this[a6_0x422e('0xf')]=process[a6_0x422e('0x10')][a6_0x422e('0x11')];this[a6_0x422e('0x12')]=this[a6_0x422e('0xf')]+'authorized_driver.jpg';this[a6_0x422e('0x13')]=this[a6_0x422e('0xf')]+a6_0x422e('0x14');this[a6_0x422e('0x15')]=0.6;this[a6_0x422e('0x16')]=0x0;this[a6_0x422e('0x17')]=0x0;console['log'](a6_0x422e('0x18'));this[a6_0x422e('0x19')]();}static[a6_0x422e('0x1a')](){if(!FaceIdService[a6_0x422e('0x1b')]){FaceIdService[a6_0x422e('0x1b')]=new FaceIdService();}return FaceIdService[a6_0x422e('0x1b')];}[a6_0x422e('0x19')](){return __awaiter(this,void 0x0,void 0x0,function*(){yield commons_1[a6_0x422e('0x1c')][a6_0x422e('0x1d')](a6_0x422e('0x1e'));yield faceapi[a6_0x422e('0x1f')][a6_0x422e('0x20')][a6_0x422e('0x1d')](a6_0x422e('0x1e'));yield faceapi['nets']['faceRecognitionNet'][a6_0x422e('0x1d')](a6_0x422e('0x1e'));setInterval(()=>{this[a6_0x422e('0x21')]();},0x3e8);});}['run'](){return __awaiter(this,void 0x0,void 0x0,function*(){console[a6_0x422e('0x22')](a6_0x422e('0x12'),this[a6_0x422e('0x12')]);console[a6_0x422e('0x22')](a6_0x422e('0x13'),this['QUERY_IMAGE']);let _0x570498=0x3;let _0xcd9f0a=null;let _0x13c0b0=null;let _0x6afb7d=null;if(fsExtra[a6_0x422e('0x23')](this[a6_0x422e('0x12')])){_0xcd9f0a=yield commons_1['canvas']['loadImage'](this[a6_0x422e('0x12')])[a6_0x422e('0x24')](function(_0x27fcb4){});_0x13c0b0=yield faceapi[a6_0x422e('0x25')](_0xcd9f0a);_0x6afb7d=yield faceapi['detectAllFaces'](_0xcd9f0a,commons_1[a6_0x422e('0x26')]);}let _0x1b5f73=null;let _0x1d4d4f=null;let _0x5d6bf4=null;if(fsExtra[a6_0x422e('0x23')](this[a6_0x422e('0x13')])){_0x1b5f73=yield commons_1['canvas'][a6_0x422e('0x27')](this['QUERY_IMAGE'])[a6_0x422e('0x24')](function(_0x7a68ad){});_0x1d4d4f=yield faceapi[a6_0x422e('0x25')](_0x1b5f73);_0x5d6bf4=yield faceapi[a6_0x422e('0x28')](_0x1b5f73,commons_1[a6_0x422e('0x26')]);}let _0x311147=0x1;if(_0x13c0b0&&_0x1d4d4f){_0x311147=faceapi[a6_0x422e('0x29')][a6_0x422e('0x2a')](faceapi[a6_0x422e('0x2b')](Array[a6_0x422e('0x2c')]['slice']['call'](_0x13c0b0),Array[a6_0x422e('0x2c')][a6_0x422e('0x2d')][a6_0x422e('0x7')](_0x1d4d4f)));}if(_0x6afb7d!=null&&_0x6afb7d['length']==0x0){_0x570498=0x2;console[a6_0x422e('0x22')](a6_0x422e('0x2e'),new Date(),_0x311147);}else if(_0x5d6bf4!=null&&_0x5d6bf4[a6_0x422e('0x2f')]==0x0){_0x570498=0x3;console[a6_0x422e('0x22')](a6_0x422e('0x30'),new Date(),_0x311147);}else{if(_0x311147>this[a6_0x422e('0x15')]){_0x570498=0x2;console[a6_0x422e('0x22')](a6_0x422e('0x31'),new Date(),_0x311147);}else{_0x570498=0x1;console[a6_0x422e('0x22')]('(match)',new Date(),_0x311147);}}if(_0x570498==this[a6_0x422e('0x16')]){this[a6_0x422e('0x17')]++;}else{this[a6_0x422e('0x17')]=0x0;}this[a6_0x422e('0x16')]=_0x570498;console[a6_0x422e('0x22')](a6_0x422e('0x32'),_0x570498,this[a6_0x422e('0x17')]);if(this[a6_0x422e('0x17')]==0x5){this['sendFaceResult'](_0x570498);}});}[a6_0x422e('0x33')](_0x7dcdae){const _0x46f552=new net[(a6_0x422e('0x34'))]();try{_0x46f552[a6_0x422e('0x35')](0x2af8,a6_0x422e('0x36'),function(){console[a6_0x422e('0x22')](a6_0x422e('0x37'));const _0x4cc88f=JSON['stringify']({'action':'face_id','data':_0x7dcdae});_0x46f552[a6_0x422e('0x38')](_0x4cc88f);});_0x46f552['on']('data',function(_0x7dcdae){console['log']('Received:\x20'+_0x7dcdae);_0x46f552[a6_0x422e('0x39')]();});_0x46f552['on'](a6_0x422e('0x3a'),function(){console[a6_0x422e('0x22')](a6_0x422e('0x3b'));});}catch(_0x307326){console[a6_0x422e('0x22')](a6_0x422e('0x3c'),_0x307326);}}}exports[a6_0x422e('0x3d')]=FaceIdService;