var a6_0x4478=['__importStar','__esModule','call','defineProperty','face-api.js','../commons','net','fs-extra','folder','REFERENCE_IMAGE','authorized_driver.jpg','QUERY_IMAGE','current_driver.jpg','threshold','countResult','log','instance','init','faceDetectionNet','../weights','nets','faceLandmark68Net','loadFromDisk','faceRecognitionNet','existsSync','catch','computeFaceDescriptor','detectAllFaces','faceDetectionOptions','canvas','round','euclideanDistance','slice','prototype','(no\x20reference\x20face)','(no\x20query\x20face)','(no\x20match)','previousResult','result','sendFaceResult','Socket','connect','localhost','stringify','face_id','write','data','destroy','close','Connection\x20closed','error','FaceIdService','__awaiter','next','throw','done','value','then','apply'];(function(_0x48ee09,_0x1b5c36){var _0x4e303b=function(_0x23122a){while(--_0x23122a){_0x48ee09['push'](_0x48ee09['shift']());}};_0x4e303b(++_0x1b5c36);}(a6_0x4478,0x196));var a6_0x5c3e=function(_0x41baf7,_0x2e28a4){_0x41baf7=_0x41baf7-0x0;var _0x4d14af=a6_0x4478[_0x41baf7];return _0x4d14af;};'use strict';var __awaiter=this&&this[a6_0x5c3e('0x0')]||function(_0x2be269,_0x5eec30,_0x4ee926,_0x33af22){function _0x162523(_0xf41614){return _0xf41614 instanceof _0x4ee926?_0xf41614:new _0x4ee926(function(_0x991bc7){_0x991bc7(_0xf41614);});}return new(_0x4ee926||(_0x4ee926=Promise))(function(_0x3c1caf,_0x567ffc){function _0x22fbd2(_0x4fb664){try{_0x1b07c8(_0x33af22[a6_0x5c3e('0x1')](_0x4fb664));}catch(_0x5168f8){_0x567ffc(_0x5168f8);}}function _0x364fcc(_0x4c3c90){try{_0x1b07c8(_0x33af22[a6_0x5c3e('0x2')](_0x4c3c90));}catch(_0x4d9ed6){_0x567ffc(_0x4d9ed6);}}function _0x1b07c8(_0x1c24d7){_0x1c24d7[a6_0x5c3e('0x3')]?_0x3c1caf(_0x1c24d7[a6_0x5c3e('0x4')]):_0x162523(_0x1c24d7[a6_0x5c3e('0x4')])[a6_0x5c3e('0x5')](_0x22fbd2,_0x364fcc);}_0x1b07c8((_0x33af22=_0x33af22[a6_0x5c3e('0x6')](_0x2be269,_0x5eec30||[]))['next']());});};var __importStar=this&&this[a6_0x5c3e('0x7')]||function(_0x46e1d4){if(_0x46e1d4&&_0x46e1d4[a6_0x5c3e('0x8')])return _0x46e1d4;var _0x4a49f4={};if(_0x46e1d4!=null)for(var _0x1c213c in _0x46e1d4)if(Object['hasOwnProperty'][a6_0x5c3e('0x9')](_0x46e1d4,_0x1c213c))_0x4a49f4[_0x1c213c]=_0x46e1d4[_0x1c213c];_0x4a49f4['default']=_0x46e1d4;return _0x4a49f4;};Object[a6_0x5c3e('0xa')](exports,a6_0x5c3e('0x8'),{'value':!![]});const faceapi=__importStar(require(a6_0x5c3e('0xb')));const commons_1=require(a6_0x5c3e('0xc'));const net=require(a6_0x5c3e('0xd'));const fsExtra=require(a6_0x5c3e('0xe'));class FaceIdService{constructor(){this['locationParts']={'latitude':'','longitude':'','speed':'','hdop':''};this[a6_0x5c3e('0xf')]=process['env']['FILES_FOLDER'];this[a6_0x5c3e('0x10')]=this[a6_0x5c3e('0xf')]+a6_0x5c3e('0x11');this[a6_0x5c3e('0x12')]=this[a6_0x5c3e('0xf')]+a6_0x5c3e('0x13');this[a6_0x5c3e('0x14')]=0.6;this['previousResult']=0x0;this[a6_0x5c3e('0x15')]=0x0;console[a6_0x5c3e('0x16')]('FaceIdService\x20init');this['init']();}static['getInstance'](){if(!FaceIdService['instance']){FaceIdService[a6_0x5c3e('0x17')]=new FaceIdService();}return FaceIdService[a6_0x5c3e('0x17')];}[a6_0x5c3e('0x18')](){return __awaiter(this,void 0x0,void 0x0,function*(){yield commons_1[a6_0x5c3e('0x19')]['loadFromDisk'](a6_0x5c3e('0x1a'));yield faceapi[a6_0x5c3e('0x1b')][a6_0x5c3e('0x1c')][a6_0x5c3e('0x1d')](a6_0x5c3e('0x1a'));yield faceapi[a6_0x5c3e('0x1b')][a6_0x5c3e('0x1e')][a6_0x5c3e('0x1d')](a6_0x5c3e('0x1a'));setInterval(()=>{this['run']();},0x3e8);});}['run'](){return __awaiter(this,void 0x0,void 0x0,function*(){console['log'](a6_0x5c3e('0x10'),this[a6_0x5c3e('0x10')]);console[a6_0x5c3e('0x16')]('QUERY_IMAGE',this[a6_0x5c3e('0x12')]);let _0x60945=0x3;let _0x1e0ce7=null;let _0x11da48=null;let _0x4ae905=null;if(fsExtra[a6_0x5c3e('0x1f')](this[a6_0x5c3e('0x10')])){_0x1e0ce7=yield commons_1['canvas']['loadImage'](this[a6_0x5c3e('0x10')])[a6_0x5c3e('0x20')](function(_0x112655){});_0x11da48=yield faceapi[a6_0x5c3e('0x21')](_0x1e0ce7);_0x4ae905=yield faceapi[a6_0x5c3e('0x22')](_0x1e0ce7,commons_1[a6_0x5c3e('0x23')]);}let _0x11dc91=null;let _0xdf3a94=null;let _0x35dc31=null;if(fsExtra[a6_0x5c3e('0x1f')](this[a6_0x5c3e('0x12')])){_0x11dc91=yield commons_1[a6_0x5c3e('0x24')]['loadImage'](this[a6_0x5c3e('0x12')])[a6_0x5c3e('0x20')](function(_0x341953){});_0xdf3a94=yield faceapi[a6_0x5c3e('0x21')](_0x11dc91);_0x35dc31=yield faceapi[a6_0x5c3e('0x22')](_0x11dc91,commons_1[a6_0x5c3e('0x23')]);}let _0x38842b=0x1;if(_0x11da48&&_0xdf3a94){_0x38842b=faceapi['utils'][a6_0x5c3e('0x25')](faceapi[a6_0x5c3e('0x26')](Array['prototype'][a6_0x5c3e('0x27')][a6_0x5c3e('0x9')](_0x11da48),Array[a6_0x5c3e('0x28')][a6_0x5c3e('0x27')][a6_0x5c3e('0x9')](_0xdf3a94)));}if(_0x4ae905!=null&&_0x4ae905['length']==0x0){_0x60945=0x2;console[a6_0x5c3e('0x16')](a6_0x5c3e('0x29'),new Date(),_0x38842b);}else if(_0x35dc31!=null&&_0x35dc31['length']==0x0){_0x60945=0x3;console[a6_0x5c3e('0x16')](a6_0x5c3e('0x2a'),new Date(),_0x38842b);}else{if(_0x38842b>this[a6_0x5c3e('0x14')]){_0x60945=0x2;console['log'](a6_0x5c3e('0x2b'),new Date(),_0x38842b);}else{_0x60945=0x1;console[a6_0x5c3e('0x16')]('(match)',new Date(),_0x38842b);}}if(_0x60945==this[a6_0x5c3e('0x2c')]){this['countResult']++;}else{this['countResult']=0x0;}this[a6_0x5c3e('0x2c')]=_0x60945;console[a6_0x5c3e('0x16')](a6_0x5c3e('0x2d'),_0x60945,this[a6_0x5c3e('0x15')]);if(this[a6_0x5c3e('0x15')]==0x5){this[a6_0x5c3e('0x2e')](_0x60945);}});}[a6_0x5c3e('0x2e')](_0x548a56){const _0x377f6e=new net[(a6_0x5c3e('0x2f'))]();try{_0x377f6e[a6_0x5c3e('0x30')](0x2af8,a6_0x5c3e('0x31'),function(){console[a6_0x5c3e('0x16')]('Connected');const _0x338ecc=JSON[a6_0x5c3e('0x32')]({'action':a6_0x5c3e('0x33'),'data':_0x548a56});_0x377f6e[a6_0x5c3e('0x34')](_0x338ecc);});_0x377f6e['on'](a6_0x5c3e('0x35'),function(_0x548a56){console[a6_0x5c3e('0x16')]('Received:\x20'+_0x548a56);_0x377f6e[a6_0x5c3e('0x36')]();});_0x377f6e['on'](a6_0x5c3e('0x37'),function(){console[a6_0x5c3e('0x16')](a6_0x5c3e('0x38'));});}catch(_0x3c87cd){console[a6_0x5c3e('0x16')](a6_0x5c3e('0x39'),_0x3c87cd);}}}exports[a6_0x5c3e('0x3a')]=FaceIdService;